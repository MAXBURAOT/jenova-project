package com.angelis.tera.game.network.packet.client;

import java.nio.ByteBuffer;

import com.angelis.tera.game.models.player.Player;
import com.angelis.tera.game.network.SystemMessages;
import com.angelis.tera.game.network.connection.TeraGameConnection;
import com.angelis.tera.game.network.packet.TeraClientPacket;
import com.angelis.tera.game.network.packet.server.SM_ACHIEVEMENT_PROGRESS_UPDATE;
import com.angelis.tera.game.network.packet.server.SM_OPCODE_LESS_PACKET;
import com.angelis.tera.game.network.packet.server.SM_PLAYER_CHANNEL_INFO;
import com.angelis.tera.game.network.packet.server.SM_PLAYER_FRIEND_LIST;
import com.angelis.tera.game.network.packet.server.SM_PLAYER_GATHER_STATS;
import com.angelis.tera.game.network.packet.server.SM_PLAYER_STATS_UPDATE;
import com.angelis.tera.game.network.packet.server.SM_PLAYER_TELEPORT;
import com.angelis.tera.game.network.packet.server.SM_USER_SETTINGS_LOAD;

public class CM_LOAD_TOPO_FIN extends TeraClientPacket {

    public CM_LOAD_TOPO_FIN(final ByteBuffer byteBuffer, final TeraGameConnection connection) {
        super(byteBuffer, connection);
    }

    @Override
    protected void readImpl() {
        // Empty packet
    }

    @Override
    protected void runImpl() {
        final Player player = this.getConnection().getActivePlayer();
        
        this.getConnection().sendPacket(new SM_PLAYER_FRIEND_LIST(player));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("ECCA00000000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("B3FA00000000"));
        
        // CONTROLLERS
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("1FB90800E00E089756120432234350528509089756522053003100430068006100740043006F006E00740072006F006C006C0065007200A201D50878DABD584D881C45147E6F7F86A550690691262CA16C37EBBA89C96632BB594A303B3B335997CCCC3633B35191B0F83392838912CD218188DEFC41F42478930111CD4DF1908328089E72F0E26183871CCD2112F0103087F5D5DB99E9EE9DEAEEEA3191651ABAFA7BBFF5D57BAF76EAEF4EFEE3877DF812E10E4EFD3C7675EAB3F11B9337C77F1CFB6EE29135B805E7E977015E8637E09349807F567F9B7CBA9B936A7F199E8312B4E9EF45F0A10A5BD0800D68429D566BD0CDED57D3C3109FDE9BFC1E0358834D5827F94A1240EBD08069B56F18D0A66789BC88F95C26E59BB04A9F3D25873F3F4F2BEBD0E2B726810A6A210DB445BF2AE9ADD2DA697AC6186ED2FB3ABB3DAFE6E23F6F917F3A804ACF815935634A63938D9538DA2D386A0B2CD8028FD9028BB6C0455BE0922DF0B82D70396EB72B9CEA1A811B44AC6EEE909A4FE2EC2EC5DB042FF33E1B75960952E753D0E0DD5E508787412D7A36786D831914D56B744353A2CE9EEE85A7F0C9C2E73576A7CA42B538026BD32749573737A7664D87428752639329506DA8D98B3C051A4E7E0A34281D61A89120FD1A11061655C11C73BB9798326771833720108BA922DAEBC6805733CA3327BDCDBAB4857AD2DEB439692FD04A4C407D509DFDAB727D75D563265A681DC6F2DD22D932799350BE3739266D22660F0240958F553B9ECF01344AD1FC75F4D1D48D1E5AA33EF4265C84B7A013EE45A98DE6419C6A6BB2E6BF413F676CAE2BF02A9CA5C6FA0E282AB76901FD2FA9FF6AC21F33A6BE4C893F07AFB0B7214F8D5CAC73FCBB6BFAD49C223796D5521CB0CCC57AD7054DBDBDA209362A7C884BCCFE8C36A2A24BAA18277A9205FA2D62AFA0713C18764E1FAE7A4F51375751ABA3391A55636DBBC6B4DC75F83FD80ED4E4CFF8E3464AB7E012BC4D14F993C81239A3993A5A7ED39F30A9CF35E135B29FA6367C0A5B5CE89BA051F98FD09F34E975EA54542E90CBFAD9A10042161ED490E83D255226686707DD1D943BE8CD8AC402E7A0FB39E30E88C481DA5971EFA15CF19E148963B5F32DBA5FB3BE7961887DB5C782126F9CF30BBA97E5FBE83D211246711DCA15096685D13C69E8BBDAF88C4898A135EA3A92C6A3C27A94EE3B5110D6D39253D156C89983227578D4EA7F42F9297A459181940313A95211C75EEF51C3B897417977DE43F70F9457D15B10962DC3C9BB3FA0DE51A343719D632065CC5474BC74EE30B13F44F319088F213AA9D7505E43EF711133CC049023C2AA1939DBE86EA3DC466F458CD894B4CDEF519EF59E1523F50D2DBF213F404F89CCED63207B4ADC872EE2DC46F751F99277585835D981F11362C45EDB37681D79D075EE47E4216D3D47164586CE1450F78048B821694FEFA2FC02A93E59DE9402561E11963726E72F74A7E58CD98669144DB161BA3FF57B86F16C0DDFA2020BCF88116E533A6F1DD9A1BA907AA7EA077F4858DCACB4DE9B284F981B50F48235C01A8FC4F03D6B8037A668F81F35CEEF4CA15FD14EA09055E0585681625681C5AC024B59058E6715580E04E6E05F77919CF3F00101C002D22952630897565246530031004D0069006E0069006D006100700043006F006E00740072006F006C006C00650072005F00530031004D0069006E0069006D00610070004F007000740069006F006E00A2010F78DAE3389F2AC4C3880400155A0167F00101C0021152E713089756521E53003100550049005F004700460078004D0061006E006100670065007200A201B91378DA8D59DB6B5CC7199F84369843094609C61837A8C627B8210D96E48A3814576756B65691D65A6BB516B40FEE6A77256DBD5A6DF66245BD406829E4294F75DA040A29ED4389DBE7B6D04B1E4AAC80F30FF4A5A514FA98401F5A6829FDBEDFCC3973DD4DBCACA473E63733DFF5F77D334ECE26C9BAD8102B6255DC14A71FFBBCA07F29FF48CE274F56445B0CE9D3107BF497337A313993891DD1138762200E08D1151D3112C7E2B420D44F64B1C60ECDECD17717E3345AAF7FF68FE9E0FC914C9E4DCED668A44BDF268DF1DF03710F3F9DBD9E4F9EB17125B14FFB0DE8CB4F400B175DA2776D1AE7D108DAD3A326EE926C5DFA94499B91582394D6E31BAC4759BAA86DFADD132DC21E31EAC1BB9B5F257D1E2E25CF24A76BB41B5B84A51CB3BEBCD73AAFF2BEE471B614CF3E8055C63CFED10B2FCBF4A9AF3D90C96C32B34A6FEF616C8475B41C279023638BBD42B3D82B23F14D428C09D383F561D91F5C4B4F16BF0B9CD2BBAF752E033B642F06B6F2EDE3E967D0241F5BF61031B10F4D3CDB939DAA588D2321BECE6CC6BB6E03D586B5945C1E1ABA9C7F389729DB2B6B4C476D418B568832F291070C6A9DC6F7DC71C43CCFED20A6FBCA7F273A9A2F271756485A8E8296B0636CE27E2F24B366C60A6C37A65527E2C9324D7A7B409F31A4603B1E4DD299FC518594ECB5651AEFEA38F8D597A5425C489E56FE68227FAAF0DD28D0F93AADDF84477BF9689975FE8A4C2E25E74CE4AF43E30124EBF9B67B2E397F5BE3145FB04C1DC46660675AB50C3D59CB48CE7CF8E8D1B57477F74CC6C85B45C46FD16A439286B36497E6107277F7214B7A8298376B56A04B2E872FA7C1AD42F331315943C798833D977C4E45C986C9E6DC32B4DF90BC3344041C108A73AD43BF7BAE97B40F940739F624FD7E55AD35ABF985FCBE0ADBB78B4C542B550C4F18A988B355D68EC4BC2B2FF6E2286BD19CA62D8FA37F3F8261FE1E6AEBFF6F85E55ACA92C5E4526CBDEB24FFC893D4D9E3C5E4B94F3B6F3E6010E39DDBD0BE15FAC5F1A18DE23A318A70D2005E1CE87A2611C526CE7F28390B246295A315FA3CE6F386AA407D1DABFE1E352B16AA888671CE1F161BC4BD3C014F5664FC0A61B95E1816CC202747D5B1AE24237726C581E1B909AB93CC37ADEA3D01457619C1225D48DB0FEC62B2B313DA6D3EB9188B03DF1F98F33DF6C4EB32B752AEB59DC95B5A12277788217CDE29C357EC49C74B14CDD3EC5FA76F863C38B0AAEE097630CCA7BA83BADB1595B52C24FB32F6EE881DBD4BBE87C559064F0C6EAAC2322CD975657E29793E44A8281F691676AA49B1FAC7E0CE9C2798397788C5FAF17C252FAF687D22B9712639A52CDAE7F71F3E5ABF962E2CA492D99133BA6FCFC18A27E8984ABA9E9469C7163C39E43AE0C5CF5EE1B576CE3F1F6DBE9EA5FF148B56FDE23AC8BCC97FB7020BC5309BB4DE9EE634DB0FB4FE85EF7C51A60FDEBD26797D539FD9C7F7420F908F6E01D3A4CA53F0B1B0BC48AB8C8A6C331D0DED54BFFFB7A5F48EFC5296F3CB40ECE90ED0E7ED2D3DCA9EB562E5EDB7FE92A5DF7EFAA54CF5127E2448271260DBB32CD5BFB3E44AF2ACB1CB3A3227C7D5C25979CC505593E206219A9A6B2CAB17B8BF2EB17FDD2C3D24DB75A2A704EE2C3ADAB6055B79DD40AC4B89F467C4FBEB90A75568C20CB8035618067B1BDF4EEB69B7A129A32AE8A6E61123FFCD6B20ADB3A14F255D30AE855A58B823D3B7DFFA00D6B6EDB1A1BB3213770E77FD222BF4B1674960EE628701FD361657B95285DF3A2ED7627C56D7EA300F2AB0BA62A3280751ECD5E095BC0352FA99089FCD54176863AAA885AD900175C6BA3DE9BCDB1151B7E37A31A807C5DEBF95EAD4A1A29E75D6DD93D765FBD21D82839B648948471068C3B9F76A0CE9F043C97094B79A1A69C133B6BD8741FD0F4F5B55CC55B9736469FE8EEE0A554751D3A7B9FC3CDB5396177E77E1A337B5C42A971D3C45AC6B85298C69F8812C92EFB24CD66DC74E02A86A86553BA1CD08C12CB3094DEE4E58C39C3BAA90661F5174FFD759FAF095DF2D855EE73D55CC1771EE55FF3CCF4AD06B84A8EB229207936B232AF0E479D113FF9B6CADDFA00A9AFEC83B0D997CA0DA50437C17BDA59DD7546537EDBED31EA308B139AE819CE35B92868E483F527D7409F204F702B83F507CB5857EA86D3A23DEFF63E6AF3725F777CB45C470CF332E6CE87725AFA53295FF39824DDC0A13B292004A9D1602FBB29C3F97743A3C01DBD8A74325A9BEE1F925AFF463F0F79A8E23C5233DFB1E08A83FE12CBD5644DB21641F590815F92C7705F1A66A9AAE9EF5FB3F029F677C4310C3287E6BDADD6E1F399E290B8E753EF774BE8ED16DC7FBBA2B9223D9CC51FD6BCEFB8174B6579793C54F3B6F8AC4A4A35DB35467D9F56F41EC28A52A27513BB98332FE7222CAE905F293C8163C7E88D86AE4B533AF34B4AAABCD1436A1DA69B8B19DDF979971D229BE96ED0FC707C49EEE8C1A74E9C312136791E77C9DAE6B463916536E5B9D5ECEB6F326BA498FF1DEC994DD710A9F364BF119DFCCEE05374B6BF017D791DC723E43183F718FD72C72CBF11259DE3EBF36F2F13FF0F87B92EF32EAB84F0A7897641817231DA3DFC2D7E7B2F45F33E7903B66AED24559BDAC39C9BA41B5AA647C4E1596096E8B480A83CFCF48A64A57B5147DB2A6BA0BBCA9FBEC5DF41F0DB7A658BC6D56357C53D3DD41DBADB90EBA829F6D7436053AB8EF28890937C917A5626E3AD395F2AEC0BED5C28DB07A6F5744EF76C0EA06CC88E5C7A0236CA3339A78274756BEAD4F8987A663301C22FDF386B90B01EABD4CF5EADEDD81414D909FA23883D787B84D6A13770FF45CE02EF13DEA1750836BE0C34E943B542FA3727E80FDEC1B3CB79B56FF9B60E471B8C2439570921C41B68EF896CD6C6573737840BBDD11F14C9F2F78647D3FB5D0FD026DDF2E5F2ED07F7FF1FBD927A1E72C8EFA47F649922C14E87A7D5B2AFEC871391F5568BE9261963AA8AB6FBC914DC661F7FA1CE19EFAF3CFA6E094054E11EEA7BFEF67CC3713EE1150A50EF5D9932374CAADB8D3991F637C1F7E642FB59DFB1375537C0351C5FDC5F1E4B328FE3F2CEF799953568A5B85F0BC3CC0EE1D8A90038ABE31F60E3814A7F906CEFA415D32270DE47186157BFA7EDAB20F30AF2DA95C3198867D8360B84DCECC24A7EA649555715BCC3C3147FEBC2CF277B7C4CBC1BB9A5833EF9E6456DA220BD1DCC7D5F30679B146FBCD3C3E8739FC9C518CD9733262DD8CE6E573F8791973F235B76986795E2574C919DFD07B187CB1E7E924B941B36B0EA242BB5D819473C5F3A2F77CD57B96DEF3AAF3CC1FB3FE2D1AB79E9F604B95C4CC67AE5A962B519DF3AD5921CDFD771B514FD4239E2845D6AB04EF3296CB7B57A6AFFFAE44F1EBBFABB29702DC66F04E46D6BB1E79B71DB1C17644E66AC42E2B840C65D98ECC0DF5DDA2F80AED179B5B8DD8AA1AC1AD46E433FE382BFE0F89BCF358F00101C002AA3F"));
        this.getConnection().sendPacket(new SM_USER_SETTINGS_LOAD(player));
        
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("51CD0000000000000000"));
        this.getConnection().sendPacket(SystemMessages.CONNECT_ON_TERA_EUROPE_FOR_LAST_NEWS());
        
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("00EA0000000000000000"));
        this.getConnection().sendPacket(new SM_PLAYER_TELEPORT(player));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("E9BE00000000ED3E0E0000800000"));
        if (player.getCreatureCurrentStats().getStamina() == 120) {
            this.getConnection().sendPacket(SystemMessages.YOU_HAVE_ABUNDANT_STAMINA());
        }
        
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("1CE9923A0E00008000007CC4000001FFFFFF7F"));
        
        this.getConnection().sendPacket(new SM_PLAYER_STATS_UPDATE(player));
        
        this.getConnection().sendPacket(new SM_PLAYER_GATHER_STATS(player.getGatherStats()));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("67BB01001400050000000000803F0000803F1400000001000000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("BE8F000000000000000000000000"));
        
        // This packet contains lot of P and Q
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("3A6C0B002000923A0E0000800000ED0200000B000000AA0000000000000020003000070000002CE6315300000000300040001300000010931A510000000040005000290000001A5619510000000050006000500000004D5119510000000060007000810000000D911A51000000007000800089000000CF4F1951000000008000900090000000D3931A51000000009000A000AF000000CB55195100000000A000B000B80000008F911A5100000000B000C00073010000ABB9355300000000C0000000E20100008D4F195100000000"));
        
        // This one is the biggest and seems to contains all alphabetic letters
        this.getConnection().sendPacket(new SM_ACHIEVEMENT_PROGRESS_UPDATE());
        
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("7656010009000009000000B20100008B7DBA2C00000000FFFFFF7F0000000000000000"));
        
        this.getConnection().sendPacket(new SM_PLAYER_STATS_UPDATE(player));
        this.getConnection().sendPacket(new SM_PLAYER_GATHER_STATS(player.getGatherStats()));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("67BB01001400050000000000803F0000803F1400000001000000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("49A0923A0E00008000000000000000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("89BC"));
        
        this.getConnection().sendPacket(new SM_PLAYER_CHANNEL_INFO(player.getChannel().getId(), player.getWorldPosition().getMapId()));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("16BAFFFFFFFF923A0E0000800000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("16BAFFFFFFFF923A0E0000800000"));
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("EEB500000000923A0E0000800000"));
        
        switch (this.getConnection().getAccount().getAccountType()) {
            case VETERAN:
                this.getConnection().sendPacket(SystemMessages.ACCOUNT_BENEFIT("433"));
            break;
            
            case NORMAL:
                // TODO
            break;
            
            case PREMIUM:
                this.getConnection().sendPacket(SystemMessages.ACCOUNT_BENEFIT("434"));
            break;
        }
        
        this.getConnection().sendPacket(new SM_OPCODE_LESS_PACKET("AFD3923A0E000080000000000000000000000000000001"));
    }

}
